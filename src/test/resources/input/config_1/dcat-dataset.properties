
# === DCAT Dataset (remaining issues patch) ===
subject.iri.json = $.datasetJson.persistentUrl

props.title_en.predicate = dct:title
props.title_en.as        = literal
props.title_en.lang      = en
props.title_en.json      = $..metadataBlocks.citation.fields[?(@.typeName=='title')].value

props.description_en.predicate = dct:description
props.description_en.as        = literal
props.description_en.lang      = en
props.description_en.json      = $..metadataBlocks.citation.fields[?(@.typeName=='dsDescription')].value[*].dsDescriptionValue.value

props.identifier.predicate = dct:identifier
props.identifier.as        = literal
props.identifier.json      = $.datasetJson.persistentUrl

props.hasVersion.predicate = dct:hasVersion
props.hasVersion.as        = literal
props.hasVersion.json.1    = $.datasetJson.datasetVersion.versionNumber
props.hasVersion.json.2    = $.datasetJson.datasetVersion.versionMinorNumber
props.hasVersion.format    = V${1}.${2}

# Issued typed as xsd:date (YYYY-MM-DD)
props.issued.predicate  = dct:issued
props.issued.as         = literal
props.issued.datatype   = xsd:date
props.issued.json       = $.datasetJson.datasetVersion.publicationDate

# Modified: keep full ISO instant and type as xsd:dateTime (matches lexical '2024-03-20T14:02:13Z')
props.modified.predicate = dct:modified
props.modified.as        = literal
props.modified.datatype  = xsd:dateTime
props.modified.json      = $.datasetJson.datasetVersion.lastUpdateTime
# props.modified.transform = iso-date-only   # REMOVED to keep time component

# Landing page
props.landingPage.predicate = dcat:landingPage
props.landingPage.as        = iri
props.landingPage.json      = $.datasetJson.persistentUrl

# Contact point
nodes.contact.kind = bnode
nodes.contact.type = vcard:Kind
nodes.contact.props.fn.predicate    = vcard:fn
nodes.contact.props.fn.as           = literal
nodes.contact.props.fn.lang         = en
nodes.contact.props.fn.json         = $..metadataBlocks.citation.fields[?(@.typeName=='datasetContact')].value[0].datasetContactName.value

nodes.contact.props.email.predicate = vcard:hasEmail
nodes.contact.props.email.as        = iri
nodes.contact.props.email.json      = $..metadataBlocks.citation.fields[?(@.typeName=='datasetContact')].value[0].datasetContactEmail.value
nodes.contact.props.email.format    = mailto:${value}

props.contactPoint.predicate = dcat:contactPoint
props.contactPoint.as        = node-ref
props.contactPoint.node      = contact

# Creators (authors) ? only items with non-empty authorName.value
nodes.creator.kind = bnode
nodes.creator.type = foaf:Person
nodes.creator.multi = true
nodes.creator.json  = $..metadataBlocks.citation.fields[?(@.typeName=='author')].value[?(@.authorName.value && @.authorName.value!='')]

nodes.creator.props.name.predicate = foaf:name
nodes.creator.props.name.as        = literal
nodes.creator.props.name.lang      = en
nodes.creator.props.name.json      = $..authorName.value

nodes.creator.props.aff.predicate  = vcard:organization-name
nodes.creator.props.aff.as         = literal
nodes.creator.props.aff.lang       = en
nodes.creator.props.aff.json       = $..authorAffiliation.value

props.creator.predicate = dct:creator
props.creator.as        = node-ref
props.creator.node      = creator
